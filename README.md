# è®°å¿†ä»£ç†äºº - æ­¦å™¨é”»é€ å°

è¿™æ˜¯ä¸ºã€Œè®°å¿†ä»£ç†äºº x è½èŠ±æ˜Ÿé›¨ã€æœåŠ¡å™¨åˆ¶ä½œçš„ä¸“å±æ­¦å™¨å®šåˆ¶ç½‘é¡µã€‚ç©å®¶å¯ä»¥åœ¨è¿™é‡Œå¯è§†åŒ–è®¾è®¡è‡ªå·±çš„ä¼ è¯´æ­¦å™¨ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è®¡ç®—ä»·æ ¼å¹¶ç”Ÿæˆé…ç½®ä»£ç ã€‚

## ğŸ® ç©å®¶ä½¿ç”¨æŒ‡å—

1. **å¡«å†™ä¿¡æ¯**ï¼šè¾“å…¥ä½ çš„æ¸¸æˆ IDï¼Œé€‰æ‹©æƒ³è¦çš„æ­¦å™¨æè´¨ï¼ˆå¦‚é’»çŸ³å‰‘ã€ä¸‹ç•Œåˆé‡‘æ–§ç­‰ï¼‰å’Œè‡ªå®šä¹‰åç§°ã€‚
2. **å®šåˆ¶å±æ€§**ï¼š
   - åœ¨å·¦ä¾§é€‰æ‹©éœ€è¦çš„å±æ€§ï¼ˆæ”»å‡»ã€é˜²å¾¡ã€ç‰¹æ®Šæ•ˆæœç­‰ï¼‰ã€‚
   - **è®¡è´¹å…¬å¼**ï¼š
    > ç³»ç»Ÿé‡‡ç”¨**å¹³æ»‘é€’å¢çš„å‡¸å‡½æ•°**å®šä»·ï¼ˆæ— é˜ˆå€¼ã€è¶Šé«˜è¶Šè´µï¼‰ï¼Œé˜²æ­¢æ•°å€¼è†¨èƒ€ï¼›éƒ¨åˆ†å±æ€§æ”¯æŒâ€œåŒºé—´è¾“å…¥â€ï¼ŒåŒºé—´ä¼šæŒ‰å‡¸å‡½æ•°çš„**æœŸæœ›ä»·æ ¼**è®¡è´¹ï¼ˆæ›´ç§‘å­¦ï¼ŒåŒºé—´è¶Šå®½è‡ªç„¶è¶Šè´µï¼‰ã€‚æ­¤å¤–è¿˜æœ‰â€œç»„åˆåŠ ä»·â€ï¼ˆæ¡æ•°è¶Šå¤šè¶Šè´µï¼‰æ¥æœç»åˆ†æ‰¹å®šåˆ¶é€ æˆçš„å¥—åˆ©ã€‚
     
    **æœ€ç»ˆä»·æ ¼è®¡ç®—ï¼ˆå®šåˆ¶æ¨¡å¼ï¼‰ï¼š**
     ```
     æœ€ç»ˆä»·æ ¼ = ceil(max(50, æ€»ä»·Raw))
     ```
     *(å³ï¼šæ€»ä»·æœ€ä½ 50 å…ƒèµ·æ­¥ï¼Œå‘ä¸Šå–æ•´)*

    **å‡çº§è¡¥å·®ä»·ï¼ˆå‡çº§æ¨¡å¼ï¼‰ï¼š**
     ```
     è¡¥å·®ä»· = ceil(max(0, æ–°æ€»ä»·Raw - æ—§æ€»ä»·Raw))
     ```
     *(è¿™ä¿è¯äº†â€œåˆ†æ‰¹å‡çº§çš„æ€»æ”¯ä»˜ = ä¸€æ¬¡æ€§å®šåˆ¶æœ€ç»ˆæ€»ä»·â€ï¼Œæ— æ³•æŠ•æœºå–å·§ã€‚å‡çº§ä¸è§¦å‘ 50 èµ·æ­¥ä»·ã€‚)*

    **å•é¡¹åŸºç¡€ä»·ï¼ˆbaseCostRawï¼‰è®¡ç®—**ï¼š
     1. **é€šç”¨ï¼ˆéåŒºé—´ï¼‰å±æ€§**ï¼šä½¿ç”¨â€œè¿›é˜¶å®šä»·æ›²çº¿â€
        ```
        æ›²çº¿ä»·Raw = val Ã— costFactor Ã— (1 + (val / curveRef) ^ gamma)
        ```
        - `val`ï¼šå±æ€§æ•°å€¼ï¼ˆç™¾åˆ†æ¯”å±æ€§åŒæ ·æŒ‰æ•°å€¼è®¡ç®—ï¼Œä¾‹å¦‚ 10% => val=10ï¼‰
        - `costFactor`ï¼šå±æ€§å•ä»·ç³»æ•°ï¼ˆå†™åœ¨å±æ€§é…ç½®é‡Œï¼‰
        - `curveRef`ï¼šæ›²çº¿å‚è€ƒç‚¹
        - `gamma`ï¼šæ›²çº¿å¹‚æŒ‡æ•°ï¼ˆç›®å‰ä¸º 1.0ï¼‰
     
    2. **æ”¯æŒåŒºé—´çš„å±æ€§**ï¼ˆç›®å‰åŒ…æ‹¬ï¼šä¼¤å®³ / PVEæ”»å‡» / PVPæ”»å‡» / çœŸå®æ”»å‡» / ç«ç„°æ”»å‡» / é›·ç”µæ”»å‡» / é˜²å¾¡ / ç”Ÿå‘½æ¢å¤ï¼‰
        - è¾“å…¥æ ¼å¼ç¤ºä¾‹ï¼š`1000-2000` / `1000~2000` / `1000ï½2000`
        - **ç§‘å­¦å®šä»·**ï¼šæŠŠåŒºé—´ç†è§£ä¸ºâ€œæ•°å€¼åœ¨åŒºé—´å†…å‡åŒ€æ³¢åŠ¨/éšæœºâ€ï¼ˆ\(V \sim U(min, max)\)ï¼‰ï¼ŒæŒ‰æœŸæœ›ä»·æ ¼è®¡è´¹ï¼š
          ```
          æ›²çº¿ä»·Raw = E[ val Ã— costFactor Ã— (1 + (val / curveRef) ^ gamma) ] ,  val ~ Uniform(min, max)
          ```
        - *(ç›´è§‚ç†è§£ï¼šåœ¨å‡¸å‡½æ•°ä¸‹ï¼ŒåŒºé—´è¶Šå®½ï¼Œä¸ç¡®å®šæ€§è¶Šå¤§ï¼ŒæœŸæœ›ä»·æ ¼è‡ªç„¶æ›´é«˜ï¼›æ— éœ€é¢å¤–æ‰‹å·¥å®½åº¦æƒ©ç½šã€‚)*

    3. **éƒ¨ä½å€ç‡ï¼ˆslotMultiplierï¼‰**
       - ä¸»æ‰‹/å¤´ç›”/è¡£æœ/è£¤å­/é‹å­ï¼š`1.0`
       - å‰¯æ‰‹ï¼š`2.0`
       - è®¡ç®—ï¼š
         ```
         baseCostRaw = æ›²çº¿ä»·Raw Ã— slotMultiplier
         ```

    4. **ç»„åˆåŠ ä»·ï¼ˆé˜¶æ¢¯å€ç‡ï¼ŒæŒ‰ baseCostRaw ä»é«˜åˆ°ä½æ’åºï¼‰**
       - ç›®çš„ï¼š**æ¡æ•°è¶Šå¤šè¶Šè´µ**ï¼Œå¹¶ä¸”å‡çº§ç”¨â€œæ–°æ€»ä»·-æ—§æ€»ä»·â€è¡¥å·®åï¼Œèƒ½ä¿è¯åˆ†æ‰¹ä¸ä¸€æ¬¡æ€§æœ€ç»ˆæ€»ä»·ä¸€è‡´ï¼ˆæ— å¥—åˆ©ï¼‰ã€‚
       - åšæ³•ï¼šæŠŠæ‰€æœ‰å·²é€‰å±æ€§çš„ `baseCostRaw` **ä»é«˜åˆ°ä½æ’åº**ï¼Œæ’åä» 0 å¼€å§‹ï¼š
         ```
         tierMultiplier(rank) = min(1 + COMBO_TIER_STEP * rank, COMBO_MULTIPLIER_CAP)
         å•é¡¹æœ€ç»ˆä»·Raw = baseCostRaw Ã— tierMultiplier(rank)
         æ€»ä»·Raw = âˆ‘ å•é¡¹æœ€ç»ˆä»·Raw
         ```
       - ç›´è§‚æ•ˆæœï¼š
         - ç¬¬ 1 æ¡ï¼ˆrank=0ï¼‰Ã—1
         - ç¬¬ 2 æ¡ï¼ˆrank=1ï¼‰Ã—(1 + step)
         - ç¬¬ 3 æ¡ï¼ˆrank=2ï¼‰Ã—(1 + 2Â·step)
         - â€¦â€¦
       - è¿™æ ·â€œæ–°å¢ä¸€ä¸ªå¾ˆå°çš„å±æ€§â€é€šå¸¸æ’åœ¨æœ«å°¾ï¼Œåªä¼šè®©æœ«å°¾é‚£ä¸€æ¡æ›´è´µï¼Œä¸ä¼šå¯¼è‡´å¤§è¯æ¡çš„å€ç‡çªç„¶è·³å˜ã€‚
     
     **å‚æ•°ç¤ºä¾‹**ï¼š
     - **éƒ¨ä½å€ç‡**ï¼šå‰¯æ‰‹ = 2.0ï¼Œå…¶ä»–éƒ¨ä½ = 1.0
     - **æœ€ä½æ¶ˆè´¹**ï¼š50 å…ƒ

     **æ˜¾ç¤ºå–æ•´è§„åˆ™ï¼ˆä¿è¯æ¯æ¡æ˜¾ç¤ºç›¸åŠ  = æ€»ä»·ï¼‰**ï¼š
     - é¡µé¢å±•ç¤ºæ¯æ¡å±æ€§æ—è¾¹çš„ `+xxx` ä¸ºæ•´æ•°ï¼Œä¸ºé¿å…â€œåˆ†åˆ« ceil åç›¸åŠ  â‰  æ€»ä»·â€çš„è¯¯å·®ï¼Œç³»ç»Ÿä¼šå¯¹å„æ¡ raw è´¹ç”¨åšä¸€æ¬¡ç»Ÿä¸€çš„å–æ•´åˆ†é…ï¼Œä½¿ï¼š
       - å®šåˆ¶æ¨¡å¼ï¼šæ‰€æœ‰ `+xxx` ç›¸åŠ  = `ceil(æ€»ä»·Raw)`ï¼ˆè‹¥è§¦å‘ 50 èµ·æ­¥ä»·ï¼Œä¼šé¢å¤–æ˜¾ç¤º `èµ·æ­¥ä»·è¡¥å·® +X`ï¼‰
       - å‡çº§æ¨¡å¼ï¼šæ‰€æœ‰ `+xxx` ç›¸åŠ  = `ceil(è¡¥å·®ä»·Raw)`
3. **æäº¤è®¢å•**ï¼š
   - æ»¡æ„åç‚¹å‡»å³ä¾§çš„ **ã€Œå¤åˆ¶é…ç½®ä»£ç ã€** æŒ‰é’®ã€‚
   - å°†å¤åˆ¶çš„å†…å®¹ç›´æ¥å‘é€ç»™æœä¸»è¿›è¡Œå®è£…ã€‚

---
*(å¼€å‘å¤‡æ³¨ï¼š`index.html` ä¸ºæ··æ·†åçš„å‘å¸ƒç‰ˆæœ¬ï¼Œ`index.dev.html` ä¸ºæœªæ··æ·†çš„æºç å¤‡ä»½)*

## ä¸€é”®ç”Ÿæˆæ··æ·†/å‘å¸ƒç‰ˆ

> ç›®æ ‡ï¼šæŠŠ `index.dev.html` ç”Ÿæˆæ–°çš„å‘å¸ƒæ–‡ä»¶ `index.html`ï¼ˆ**JS æ··æ·† + HTML/CSS å‹ç¼©**ï¼‰ã€‚

- æ··æ·†ä½¿ç”¨ `javascript-obfuscator`ï¼Œå‹ç¼©ä½¿ç”¨ `html-minifier-terser`ï¼ˆé¦–æ¬¡è¿è¡Œä¼šé€šè¿‡ `npx` è‡ªåŠ¨ä¸‹è½½æ‰€éœ€å·¥å…·ï¼‰

```bash
node tools/build-obfuscate.cjs
```

- æœ€å¼ºæ··æ·†ï¼ˆæ›´æ…¢ã€ä¹Ÿæ›´å¯èƒ½é‡åˆ°å…¼å®¹é—®é¢˜ï¼‰ï¼š

```bash
node tools/build-obfuscate.cjs --high
```
